<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jellyfish Bloom</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <canvas id="canvas"></canvas>

    <!-- Pause Overlay -->
    <div id="pauseOverlay" class="pause-overlay hidden">
        <span>PAUSED</span>
    </div>

    <!-- Instrumentation Panel -->
    <div id="statsPanel" class="panel stats-panel">
        <div class="stat">
            <span class="stat-icon">&#9201;</span>
            <span class="stat-label">FPS</span>
            <span id="fpsValue" class="stat-value">60</span>
        </div>
        <div class="stat">
            <span class="stat-icon">&#9679;</span>
            <span class="stat-label">Boids</span>
            <span id="boidCount" class="stat-value">100</span>
        </div>
        <div class="stat">
            <span class="stat-icon">&#8644;</span>
            <span class="stat-label">Avg Speed</span>
            <span id="avgSpeed" class="stat-value">0.0</span>
        </div>
        <div class="stat">
            <span class="stat-icon">&#8599;</span>
            <span class="stat-label">Avg Neighbors</span>
            <span id="avgNeighbors" class="stat-value">0</span>
        </div>
    </div>

    <!-- Control Panel -->
    <div id="controlPanel" class="panel control-panel">
        <div class="panel-header" onclick="togglePanel('controlPanel')">
            <h2>Controls</h2>
            <span class="toggle-icon">&#9660;</span>
        </div>
        <div class="panel-content">
            <!-- Behavior Group -->
            <div class="control-group collapsible">
                <h3 class="group-header">Behavior <span class="collapse-icon">▼</span></h3>
                <div class="group-content">

                <div class="control">
                    <label for="separationSlider">
                        Separation
                        <span class="tooltip" data-tip="How strongly boids avoid crowding neighbors">?</span>
                    </label>
                    <input type="range" id="separationSlider" min="0" max="5" step="0.1" value="1.5">
                    <span id="separationValue" class="value-display">1.5</span>
                </div>

                <div class="control">
                    <label for="alignmentSlider">
                        Alignment
                        <span class="tooltip" data-tip="How much boids match neighbors' velocity direction">?</span>
                    </label>
                    <input type="range" id="alignmentSlider" min="0" max="5" step="0.1" value="1.0">
                    <span id="alignmentValue" class="value-display">1.0</span>
                </div>

                <div class="control">
                    <label for="cohesionSlider">
                        Cohesion
                        <span class="tooltip" data-tip="How strongly boids move toward the group center">?</span>
                    </label>
                    <input type="range" id="cohesionSlider" min="0" max="5" step="0.1" value="1.0">
                    <span id="cohesionValue" class="value-display">1.0</span>
                </div>

                <div class="control">
                    <label for="neighborRadiusSlider">
                        Neighbor Radius
                        <span class="tooltip" data-tip="Detection range for nearby boids (pixels)">?</span>
                    </label>
                    <input type="range" id="neighborRadiusSlider" min="10" max="200" step="5" value="50">
                    <span id="neighborRadiusValue" class="value-display">50</span>
                </div>

                <div class="control">
                    <label for="maxSpeedSlider">
                        Max Speed
                        <span class="tooltip" data-tip="Maximum velocity of boids">?</span>
                    </label>
                    <input type="range" id="maxSpeedSlider" min="1" max="10" step="0.5" value="4">
                    <span id="maxSpeedValue" class="value-display">4</span>
                </div>

                <div class="control">
                    <label for="maxForceSlider">
                        Steering Force
                        <span class="tooltip" data-tip="How quickly boids can change direction">?</span>
                    </label>
                    <input type="range" id="maxForceSlider" min="0.05" max="0.5" step="0.01" value="0.2">
                    <span id="maxForceValue" class="value-display">0.2</span>
                </div>
                </div>
            </div>

            <!-- Appearance Group -->
            <div class="control-group collapsible">
                <h3 class="group-header">Appearance <span class="collapse-icon">▼</span></h3>
                <div class="group-content">
                <div class="control">
                    <label for="boidCountSlider">
                        Boid Count
                        <span class="tooltip" data-tip="Number of boids in the simulation">?</span>
                    </label>
                    <input type="range" id="boidCountSlider" min="10" max="1000" step="10" value="100">
                    <span id="boidCountValue" class="value-display">100</span>
                </div>

                <div class="control">
                    <label for="trailLengthSlider">
                        Trail Length
                        <span class="tooltip" data-tip="Motion trail persistence (frames)">?</span>
                    </label>
                    <input type="range" id="trailLengthSlider" min="0" max="50" step="5" value="10">
                    <span id="trailLengthValue" class="value-display">10</span>
                </div>

                <div class="control">
                    <label for="visionAngleSlider">
                        Vision Angle
                        <span class="tooltip" data-tip="Field of view angle for detecting neighbors">?</span>
                    </label>
                    <input type="range" id="visionAngleSlider" min="60" max="360" step="10" value="270">
                    <span id="visionAngleValue" class="value-display">270°</span>
                </div>
                <div class="vision-presets">
                    <button id="vision360" class="mini-btn">360° Omni</button>
                    <button id="vision180" class="mini-btn">180° Forward</button>
                    <button id="vision90" class="mini-btn">90° Narrow</button>
                </div>
                <div class="control checkbox-control">
                    <label>
                        <input type="checkbox" id="showCones"> Show Vision Cones
                    </label>
                </div>
                </div>
            </div>

            <!-- Species -->
            <div class="control-group collapsible">
                <h3 class="group-header">Species <span class="collapse-icon">▼</span></h3>
                <div class="group-content">
                <div class="control">
                    <label for="speciesCountSlider">
                        Species Count
                        <span class="tooltip" data-tip="Number of distinct species/swarms">?</span>
                    </label>
                    <input type="range" id="speciesCountSlider" min="1" max="5" step="1" value="1">
                    <span id="speciesCountValue" class="value-display">1</span>
                </div>
                <div class="control">
                    <label for="speciesInteraction">
                        Interaction Mode
                        <span class="tooltip" data-tip="How species interact with each other">?</span>
                    </label>
                    <select id="speciesInteraction" class="track-select">
                        <option value="separate">Separate Flocks</option>
                        <option value="mixed">Mixed (Prefer Own)</option>
                        <option value="unified">Unified (Ignore Species)</option>
                    </select>
                </div>
                <div class="species-preview" id="speciesPreview">
                    <span class="species-dot" style="background: #00ffff;"></span>
                </div>
                </div>
            </div>

            <!-- Constellation -->
            <div class="control-group collapsible">
                <h3 class="group-header">Constellation <span class="collapse-icon">▼</span></h3>
                <div class="group-content">
                <div class="control checkbox-control">
                    <label>
                        <input type="checkbox" id="constellationMode"> Enable Constellation Mode
                    </label>
                </div>
                <div class="control">
                    <label for="constellationRadius">
                        Connection Radius
                        <span class="tooltip" data-tip="Maximum distance for drawing connections">?</span>
                    </label>
                    <input type="range" id="constellationRadius" min="30" max="150" step="10" value="60">
                    <span id="constellationRadiusValue" class="value-display">60</span>
                </div>
                <div class="control">
                    <label for="constellationOpacity">
                        Line Opacity
                        <span class="tooltip" data-tip="Brightness of constellation lines">?</span>
                    </label>
                    <input type="range" id="constellationOpacity" min="0.1" max="1" step="0.1" value="0.4">
                    <span id="constellationOpacityValue" class="value-display">0.4</span>
                </div>
                <div class="control checkbox-control">
                    <label>
                        <input type="checkbox" id="constellationSameSpecies" checked> Same Species Only
                    </label>
                </div>
                </div>
            </div>

            <!-- Flow Field -->
            <div class="control-group collapsible collapsed">
                <h3 class="group-header">Flow Field <span class="collapse-icon">▼</span></h3>
                <div class="group-content">
                <div class="control checkbox-control">
                    <label>
                        <input type="checkbox" id="flowFieldEnabled"> Enable Flow Field
                    </label>
                </div>
                <div class="control">
                    <label for="flowFieldStrength">
                        Flow Strength
                        <span class="tooltip" data-tip="How strongly boids follow the flow field">?</span>
                    </label>
                    <input type="range" id="flowFieldStrength" min="0.1" max="1" step="0.1" value="0.3">
                    <span id="flowFieldStrengthValue" class="value-display">0.3</span>
                </div>
                <div class="control checkbox-control">
                    <label>
                        <input type="checkbox" id="showFlowField"> Show Flow Vectors
                    </label>
                </div>
                </div>
            </div>

            <!-- Presets -->
            <div class="control-group collapsible">
                <h3 class="group-header">Presets <span class="collapse-icon">▼</span></h3>
                <div class="group-content">
                <div class="preset-buttons">
                    <button id="presetRave" class="preset-btn" data-tip="Synchronized flowing movement like dancers in a crowd">
                        Rave Swarm
                    </button>
                    <button id="presetChaos" class="preset-btn" data-tip="Wild, unpredictable energy with minimal coordination">
                        Chaos Mosh
                    </button>
                    <button id="presetBass" class="preset-btn" data-tip="Tightly packed group with strong attraction">
                        Bass Drop
                    </button>
                </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="control-group">
                <h3>Actions</h3>
                <div class="action-buttons">
                    <button id="pauseBtn" class="action-btn">
                        <span id="pauseIcon">&#10074;&#10074;</span> Pause
                    </button>
                    <button id="resetBtn" class="action-btn" data-tip="Randomize positions?">
                        &#8634; Reset
                    </button>
                    <button id="fullscreenBtn" class="action-btn">
                        <span id="fullscreenIcon">&#x26F6;</span> Fullscreen
                    </button>
                    <button id="boundaryBtn" class="action-btn">
                        <span id="boundaryIcon">&#8644;</span> <span id="boundaryText">Wrap</span>
                    </button>
                </div>
            </div>

            <!-- Music -->
            <div class="control-group collapsible collapsed">
                <h3 class="group-header">Music <span class="collapse-icon">▼</span></h3>
                <div class="group-content">
                <div class="control">
                    <label for="styleSelect">
                        Style
                        <span class="tooltip" data-tip="Choose a music style">?</span>
                    </label>
                    <select id="styleSelect" class="track-select">
                        <option value="0">House (128 BPM)</option>
                        <option value="1">Techno (138 BPM)</option>
                        <option value="2">Trance (140 BPM)</option>
                        <option value="3">Ambient (100 BPM)</option>
                    </select>
                </div>
                <div class="action-buttons">
                    <button id="musicBtn" class="action-btn music-btn">
                        <span id="musicIcon">&#9835;</span> Play
                    </button>
                </div>
                <div class="control">
                    <label for="volumeSlider">
                        Volume
                        <span class="tooltip" data-tip="Music volume">?</span>
                    </label>
                    <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="0.5">
                    <span id="volumeValue" class="value-display">50%</span>
                </div>
                </div>
            </div>

            <!-- Performance -->
            <div class="control-group collapsible collapsed">
                <h3 class="group-header">Performance <span class="collapse-icon">▼</span></h3>
                <div class="group-content">
                <div class="control checkbox-control">
                    <label>
                        <input type="checkbox" id="spatialGrid" checked> Spatial Grid (O(n) vs O(n²))
                    </label>
                </div>
                <div class="perf-stats">
                    <div class="perf-stat">
                        <span class="perf-label">Algorithm:</span>
                        <span id="algorithmMode" class="perf-value">Grid O(n)</span>
                    </div>
                    <div class="perf-stat">
                        <span class="perf-label">Neighbor Checks:</span>
                        <span id="neighborChecks" class="perf-value">0</span>
                    </div>
                    <div class="perf-stat">
                        <span class="perf-label">Theoretical Max:</span>
                        <span id="theoreticalMax" class="perf-value">0</span>
                    </div>
                </div>
                </div>
            </div>

            <!-- Mouse Interaction -->
            <div class="control-group collapsible collapsed">
                <h3 class="group-header">Controls <span class="collapse-icon">▼</span></h3>
                <div class="group-content">
                <div class="interaction-info">
                    <p><strong>Left Click + Drag:</strong> Attract boids</p>
                    <p><strong>Right Click + Drag:</strong> Repel boids</p>
                    <p><strong>Ctrl/Cmd + Drag:</strong> Paint obstacles</p>
                    <p><strong>Shift + Click:</strong> Spawn 10 boids</p>
                    <p><strong>Spacebar:</strong> Pause/Resume</p>
                    <p><strong>F:</strong> Toggle Fullscreen</p>
                </div>
                <div class="control">
                    <label for="mouseForceSlider">
                        Mouse Force
                        <span class="tooltip" data-tip="Strength of mouse attract/repel">?</span>
                    </label>
                    <input type="range" id="mouseForceSlider" min="0.1" max="3" step="0.1" value="1">
                    <span id="mouseForceValue" class="value-display">1.0</span>
                </div>
                <div class="obstacle-controls">
                    <span class="obstacle-label">Obstacles: <span id="obstacleCount">0</span></span>
                    <button id="clearObstaclesBtn" class="action-btn small">Clear All</button>
                </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mouse Indicator -->
    <div id="mouseIndicator" class="mouse-indicator hidden"></div>

    <script src="script.js"></script>
</body>
</html>
